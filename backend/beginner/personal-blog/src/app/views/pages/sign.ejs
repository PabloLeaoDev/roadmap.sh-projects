<div class="login-container">
    <div class="login-header">
        <h1>Painel Administrativo</h1>
        <p>Faça login para acessar o sistema</p>
    </div>

    <% if (typeof error !== 'undefined' && error) { %>
        <div class="alert alert-danger">
            <%= error %>
        </div>
    <% } %>

    <% if (typeof success !== 'undefined' && success) { %>
        <div class="alert alert-success">
            <%= success %>
        </div>
    <% } %>

    <form id="loginForm" method="post">
        <div class="form-group">
            <label for="name">Usuário:</label>
            <input 
                type="text" 
                class="form-control" 
                id="name" 
                name="name" 
                value="<%= typeof name !== 'undefined' ? name : '' %>"
            >
        </div>

        <div class="form-group">
            <label for="email">Email:</label>
            <input 
                type="email" 
                class="form-control" 
                id="email" 
                name="email" 
                value="<%= typeof email !== 'undefined' ? email : '' %>"
            >
        </div>

        <div class="form-group">
            <label for="password">Senha:</label>
            <input 
                type="password" 
                class="form-control" 
                id="password" 
                name="password" 
                required
            >
        </div>

        <% if (isSignup) { %>
            <div class="form-group">
                <label for="confirm-password">Confirme a Senha:</label>
                <input 
                    type="password" 
                    class="form-control" 
                    id="confirm-password" 
                    name="confirmPassword" 
                    required
                >
            </div>

            <button type="submit" class="btn">Cadastrar</button>
            <a href="/login" class="btn">Voltar</a>
        <% } else { %>
            <button type="submit" class="btn">Entrar</button>
            <a href="/" class="btn">Voltar</a>
        <% } %>

        <a href="/singup">Ainda não possui uma conta? Clique aqui</a>
    </form>
</div>
<script>
    loginForm.addEventListener('submit', async (event) => {
        event.preventDefault();

        const formData = new FormData(loginForm);
        const data = Object.fromEntries(formData.entries());

        const response = await fetch(`/admin/<% isSignup ? 'signup' : 'login' %>`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        });

        const result = await response.json();
        
        if (result.success && result.redirectUrl)
            window.location.href = result.redirectUrl; 
        else
            alert('<% isSignup ? "Signup" : "Signin" %> Error');
    });
</script>
