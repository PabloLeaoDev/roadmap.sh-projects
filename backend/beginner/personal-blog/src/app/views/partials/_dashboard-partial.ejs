<div class="page-header">
    <div>
        <h2 class="page-title">Gerenciar Artigos</h2>
        <p>Total de artigos: <span id="post-count"><%= posts ? posts.length : 0 %></span></p>
    </div>
    <button class="btn btn-primary"
            hx-get="/admin/post/new-form"
            hx-target="#modal-body"
            hx-swap="innerHTML"
            _="on htmx:afterOnLoad call openModal('Novo Post')">
        + Novo Post
    </button>
</div>

<div class="articles-container">
    <div class="articles-header">
        <h3>Lista de Posts</h3>
    </div>

    <table class="articles-table">
        <% if (posts && posts.length > 0) { %>
            <thead>
        <% } else { %>
            <thead style="display: none;">
        <% } %>
            <tr>
                <th>ID</th>
                <th>T√≠tulo</th>
                <th>Autor</th>
                <th>Status</th>
                <th>Criado em</th>
                <th>A√ß√µes</th>
            </tr>
        </thead>
        <tbody id="posts-body">
            <% if (posts && posts.length > 0) { %>
                <% posts.reverse().forEach((post) => { %>
                    <tr id="post-row-<%= post.id %>">
                        <td><%= post.id %></td>
                        <td class="article-title" title="<%= post.title %>">
                            <a href="/post/<%= post.id %>" 
                               hx-get="/post/<%= post.id %>"
                               hx-push-url="true"
                               hx-target=".main-content">
                                <%= post.title %>
                            </a>
                        </td>
                        <td><%= post.author || 'N√£o informado' %></td>
                        <td>
                            <span class="article-status <%= post.status === 'published' ? 'status-published' : 'status-draft' %>">
                                <%= post.status === 'published' ? 'Publicado' : 'Rascunho' %>
                            </span>
                        </td>
                        <td>
                            <%= post.createdAt ? new Date(post.createdAt).toLocaleDateString('pt-BR') : 'N/A' %>
                        </td>
                        <td class="actions">
                            <button class="btn btn-warning btn-sm"
                                    hx-get="/admin/post/edit-form/<%= post.id %>"
                                    hx-target="#modal-body"
                                    hx-swap="innerHTML"
                                    _="on htmx:afterOnLoad call openModal('Editar Post')">
                                ‚úèÔ∏è Editar
                            </button>
                            <button class="btn btn-danger btn-sm" id="deleteBtn"
                                    hx-delete="/admin/post/delete/<%= post.id %>"
                                    hx-confirm="Tem certeza que deseja excluir este post?"
                                    hx-target="#post-row-<%= post.id %>"
                                    hx-swap="outerHTML"
                                    hx-indicator="#dashboard-loader">
                                üóëÔ∏è Excluir
                            </button>
                        </td>
                    </tr>
                <% }); %>
            <% } else { %>
                <div class="no-articles">
                    <div style="font-size: 3rem; margin-bottom: 1rem;">üìÑ</div>
                    <h3>Nenhum post encontrado</h3>
                    <p>Comece criando seu primeiro post clicando no bot√£o "Novo Post" acima.</p>
                </div>
            <% } %>
        </tbody>
    </table>
</div>